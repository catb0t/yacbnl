#include<criterion/criterion.h>
#include"yacbnl.h"
Test(t,bna_u64){atom_t*a=to_digit_array(0,0,BN_NONE,0),z[]={0,0,0,0};cr_assert_arr_eq(z,a,sz(HEADER_OFFSET,atom_t));free(a);a=to_digit_array(0,1,BN_NONE,0);atom_t s[]={0,1,0,0,1};cr_assert_arr_eq(s,a,sz(1+HEADER_OFFSET,atom_t));free(a);a=to_digit_array(0,23,BN_NONE,0);atom_t s2[]={0,2,0,0,2,3};cr_assert_arr_eq(s2,a,sz(2+HEADER_OFFSET,atom_t));free(a);a=to_digit_array(0,12345678901234567890U,0,0);atom_t s3[20+HEADER_OFFSET]={0,20,0,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0};cr_assert_arr_eq(s3,a,sz(20+HEADER_OFFSET,atom_t));free(a);}Test(t,bna_s64){atom_t*a=to_digit_array(0,0,FL_SIGN,0),z[]={0,0,0,FL_SIGN};cr_assert_arr_eq(z,a,sz(HEADER_OFFSET,atom_t));free(a);a=to_digit_array(0,1,FL_SIGN,0);atom_t n1[]={0,1,0,FL_SIGN,1};cr_assert_arr_eq(n1,a,sz(1+HEADER_OFFSET,atom_t));free(a);a=to_digit_array(0,2345,FL_SIGN,0);atom_t n2[]={0,4,0,FL_SIGN,2,3,4,5};cr_assert_arr_eq(n2,a,sz(4+HEADER_OFFSET,atom_t));free(a);}Test(addrmodes,1to2){atom_t h,l;u16_to_twoba(2340,&h,&l);cr_assert(h==9&&l==36);u16_to_twoba(65533,&h,&l);cr_assert(h==255&&l==253);u16_to_twoba(65535,&h,&l);cr_assert_eq(h,l);cr_assert(h==255);u16_to_twoba(256,&h,&l);cr_assert(h==1&&l==0);u16_to_twoba(257,&h,&l);cr_assert_eq(h,l);cr_assert(h==1);u16_to_twoba(0,&h,&l);cr_assert_eq(h,l);cr_assert(h==0);}Test(addrmodes,2to1){cr_assert_eq(2340,twoba_to_u16(9,36));cr_assert_eq(65533,twoba_to_u16(255,253));cr_assert_eq(65535,twoba_to_u16(255,255));cr_assert_eq(256,twoba_to_u16(1,0));cr_assert_eq(257,twoba_to_u16(1,1));cr_assert_eq(0,twoba_to_u16(0,0));}Test(t,count){cr_assert_eq(1,count_digits_u64(1));cr_assert_eq(2,count_digits_u64(20));cr_assert_eq(6,count_digits_u64(200000));cr_assert_eq(20,count_digits_u64(12345678901234567890U));}Test(t,idx){cr_assert_eq(0,indexable_digits_u64(1));cr_assert_eq(1,indexable_digits_u64(20));cr_assert_eq(4,indexable_digits_u64(12345));cr_assert_eq(5,indexable_digits_u64(200000));cr_assert_eq(19,indexable_digits_u64(12345678901234567890U));}Test(t,getn){uint64_t x=12345;for(size_t i=0;i<5;i++){atom_t res=get_left_nth_digit(x,(atom_t)i);cr_assert_eq(i+1,res);}x=12345678901234567890U;for(size_t i=0;i<20;i++){cr_assert_eq((i+1)%10,get_left_nth_digit(x,(atom_t)i));}}
